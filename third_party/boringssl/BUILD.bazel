config_setting(
    name = "aarch64_linux_build",
    # constraint_values = [
    #     "@platforms//cpu:aarch64",
    #     "@platforms//os:linux",
    # ],
    values = {
        "cpu": "aarch64",
    },
    visibility = ["//visibility:public"],
)

config_setting(
    name = "arm7_linux_build",
    # constraint_values = [
    #     "@platforms//cpu:armv7",
    #     "@platforms//os:linux",
    # ],
    values = {
        "cpu": "armv7",
    },
    visibility = ["//visibility:public"],
)

config_setting(
    name = "x86_64_linux_build",
    # constraint_values = [
    #     "@platforms//cpu:x86_64",
    #     "@platforms//os:linux",
    # ],
    values = {
        "cpu": "k8",
    },
    visibility = ["//visibility:public"],
)

cc_library(
    name = "host_openssl",
    linkopts = [
        "-lssl",
        "-lcrypto",
    ],
)

cc_library(
    name = "ssl",
    visibility = ["//visibility:public"],
    deps = select({
        ":aarch64_linux_build": [
            "@openssl//:ssl",
        ],
        ":x86_64_linux_build": [
            ":host_openssl",
        ],
        # TODO(james): Add other platform selectors as appropriate.
        "//conditions:default": [],
    }),
)

cc_library(
    name = "crypto",
    visibility = ["//visibility:public"],
    deps = select({
        ":aarch64_linux_build": [
            "@openssl//:ssl",
        ],
        ":x86_64_linux_build": [
            ":host_openssl",
        ],
        # TODO(james): Add other platform selectors as appropriate.
        "//conditions:default": [],
    }),
)
