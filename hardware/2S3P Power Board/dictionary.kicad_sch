(kicad_sch (version 20230121) (generator eeschema)

  (uuid 596ad061-f3fc-4308-b829-da0d859d0522)

  (paper "USLetter")

  (lib_symbols
    (symbol "power:GNDREF" (power) (pin_names (offset 0)) (in_bom yes) (on_board yes)
      (property "Reference" "#PWR" (at 0 -6.35 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Value" "GNDREF" (at 0 -3.81 0)
        (effects (font (size 1.27 1.27)))
      )
      (property "Footprint" "" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "Datasheet" "" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_keywords" "global power" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (property "ki_description" "Power symbol creates a global label with name \"GNDREF\" , reference supply ground" (at 0 0 0)
        (effects (font (size 1.27 1.27)) hide)
      )
      (symbol "GNDREF_0_1"
        (polyline
          (pts
            (xy -0.635 -1.905)
            (xy 0.635 -1.905)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy -0.127 -2.54)
            (xy 0.127 -2.54)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 0 -1.27)
            (xy 0 0)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
        (polyline
          (pts
            (xy 1.27 -1.27)
            (xy -1.27 -1.27)
          )
          (stroke (width 0) (type default))
          (fill (type none))
        )
      )
      (symbol "GNDREF_1_1"
        (pin power_in line (at 0 0 270) (length 0) hide
          (name "GNDREF" (effects (font (size 1.27 1.27))))
          (number "1" (effects (font (size 1.27 1.27))))
        )
      )
    )
  )


  (rectangle (start 22.86 21.082) (end 94.488 63.627)
    (stroke (width 0) (type default))
    (fill (type none))
    (uuid 35c1371e-eb32-41b2-92c0-3ec82f6ac94f)
  )
  (rectangle (start 22.098 87.757) (end 94.488 119.507)
    (stroke (width 0) (type default))
    (fill (type none))
    (uuid 69cb58d2-b28b-4847-869d-b8dcbc46ecca)
  )
  (rectangle (start 22.098 124.587) (end 94.488 160.782)
    (stroke (width 0) (type default))
    (fill (type none))
    (uuid 700f2464-8918-483b-aa40-ec53cbb4f414)
  )
  (rectangle (start 22.352 68.199) (end 94.488 83.439)
    (stroke (width 0) (type default))
    (fill (type none))
    (uuid 92a9cf6a-430a-4b66-85df-e25bdd5db0f4)
  )

  (text_box "PACK +/- are the primary power lines coming from the battery pack after the battery protection circuit. The battery protection circuit creates PACK- from B-. PACK+ is the same as B+.\n\nPACK+ is the high voltage line coming from the positive pole of the high-side batteries.\n\nB- is the negative pole of the low-side batteries. This is not the same as PACK-. \n\nBM is the voltage in the middle; the positive pole of the low-side and negative pole of the high-side batteries.\n\nLogically, B+ (if it existed), B- and BM are the direct voltages from the batteries. PACK+ and PACK- are the primary power voltages coming from the battery pack.\n\nBAT_THERM is the voltage drop across the thermistor at the battery pack. We might be able to replace this signal with a value from the I2C temperature monitoring ICs. But it might also be nice to expose a method to measure the temperature directly with a voltmeter."
    (at 97.282 20.828 0) (size 85.09 42.545)
    (stroke (width 0) (type default))
    (fill (type none))
    (effects (font (size 1.27 1.27)) (justify left top))
    (uuid ccc15bef-d6cb-4cd4-8ffb-639dbc363fa4)
  )
  (text_box "VBATT is the voltage of the battery pack. It is the same as PACK+ minus the voltage drop across the current sense resistor.\n\nVBUS_RESET This is a reset line coming from the primary MCU. It allows the system to reset itself from software.\n"
    (at 97.536 68.072 0) (size 85.09 15.24)
    (stroke (width 0) (type default))
    (fill (type none))
    (effects (font (size 1.27 1.27)) (justify left top))
    (uuid d8e610dc-4c95-4f8a-8ec3-7d207d5b28e3)
  )
  (text_box "VBATT is the voltage of the battery pack PACK+ after the drop across the current measurement resistor related to VBATT_SENSE.\n\nVCHRG is the charging voltage from the charging circuitry. It should be sent back to PACK+ to charge the batteries.\n\nUSB_D+/- are the differential USB data signals. They are used here to detect presence of a USB power source.\n\nVBUS_IN is the USB power voltage, approximately 5V over GNDREF.\n\nGNDREF is the ground of the USB host. It is separate from the battery GND when the batteries are not being charged, but the two are shorted together to charge the batteries or to run the system from USB power.\n"
    (at 97.663 124.587 0) (size 85.217 36.195)
    (stroke (width 0) (type default))
    (fill (type none))
    (effects (font (size 1.27 1.27)) (justify left top))
    (uuid e8176a70-47a2-438a-9e92-774289d1475b)
  )
  (text_box "SCL_PWR and SDA_PWR are the I2C bus signals for the power board. They may be shared with other devices not on the power board.\n\nVBATT_SENSE is the positive voltage coming from the battery pack after the voltage drop across the current sensing resistor. This signal is the net voltage from a high-side current monitor. PACK+ gets fed directly into VBATT_SENSE, and VBATT is the voltage that is fed into the power regulator.\n\n"
    (at 97.663 87.757 0) (size 85.09 32.385)
    (stroke (width 0) (type default))
    (fill (type none))
    (effects (font (size 1.27 1.27)) (justify left top))
    (uuid fb7ed0d0-38a7-4883-a96a-d7657f4e1dc0)
  )

  (text "Monitoring and Testing Symbols" (at 22.098 87.122 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
    (uuid 040a5423-8211-4451-8cbb-f20519e112ff)
  )
  (text "Battery Charging Symbols" (at 22.098 123.698 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
    (uuid 333f1ace-3b1f-4fa9-8fb9-e675b5758552)
  )
  (text "Battery Pack Symbols" (at 22.606 20.574 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
    (uuid 672800ee-5580-411c-9e13-6b14280c6c68)
  )
  (text "Power Regulator Symbols" (at 22.352 67.818 0)
    (effects (font (size 1.27 1.27)) (justify left bottom))
    (uuid ddcbe785-a8f3-4866-9cfc-f91c8d1e91ba)
  )

  (global_label "PACK-" (shape bidirectional) (at 53.34 33.655 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 1137be2f-4aa9-4be9-be57-3e43df40c2c1)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 53.34 33.655 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "BAT_THERM" (shape bidirectional) (at 53.34 36.195 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 22b77e33-09ab-4f01-8661-88e543e188a2)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 53.34 36.195 0)
      (effects (font (size 1.27 1.27)) (justify right) hide)
    )
  )
  (global_label "BM" (shape bidirectional) (at 53.34 28.575 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 2ec9382a-86dc-43a0-a17a-6748db92d041)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 53.34 28.575 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "SCL_PWR" (shape input) (at 41.148 94.107 180) (fields_autoplaced)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 34cbcae1-6750-4ec6-bb05-0d525277c2f9)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 29.6962 94.107 0)
      (effects (font (size 1.27 1.27)) (justify right) hide)
    )
  )
  (global_label "PACK+" (shape bidirectional) (at 53.34 31.115 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 35d403c6-c6ed-4042-a400-c3876fc99598)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 53.34 31.115 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "SDA_PWR" (shape input) (at 41.148 96.647 180) (fields_autoplaced)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 3b64b51d-99bb-4d83-91ed-359280a5878e)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 29.6357 96.647 0)
      (effects (font (size 1.27 1.27)) (justify right) hide)
    )
  )
  (global_label "VCHRG" (shape bidirectional) (at 48.768 137.922 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 3c3869e4-46ce-44bb-aefe-e9b1c7cdf0e3)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 48.768 137.922 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "VBATT" (shape bidirectional) (at 48.768 135.382 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 3fc90585-bb49-4caa-bac9-003cf549811a)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 48.768 135.382 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "USB_D+" (shape bidirectional) (at 48.768 150.622 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 478a719a-f5b4-4542-bf34-7a733e05b73e)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 48.768 150.622 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "B-" (shape bidirectional) (at 53.34 26.035 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 4ae71947-087c-4606-aa94-fffc98357370)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 53.34 26.035 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "VBATT_SENSE" (shape bidirectional) (at 41.148 99.187 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid 5a7abbff-82db-4eee-b8ca-4454c90467f7)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 41.148 99.187 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "VBUS_RESET" (shape input) (at 49.53 75.565 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid a3bd1259-674a-47b4-8a24-8f994f0246fb)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 49.53 75.565 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "THM" (shape bidirectional) (at 48.768 140.462 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid af5904c8-a6d6-4569-b0a8-cb7a6efa81b1)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 48.768 140.462 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "STAT" (shape bidirectional) (at 48.768 143.002 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid bae54d1d-ecae-4974-9698-7ee47d207e2d)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 48.768 143.002 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "VBUS_IN" (shape bidirectional) (at 48.768 145.542 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid cbb8e16d-6ee0-4dbf-bd44-7be8d97fb395)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 48.768 145.542 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "VBATT" (shape bidirectional) (at 49.53 73.025 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid d42feace-b3b9-486c-ba3b-d4b9a6ba1eca)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 49.53 73.025 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )
  (global_label "USB_D-" (shape bidirectional) (at 48.768 148.082 180)
    (effects (font (size 1.27 1.27)) (justify right))
    (uuid ea14934b-5974-4205-a982-10c3df773b8c)
    (property "Intersheetrefs" "${INTERSHEET_REFS}" (at 48.768 148.082 0)
      (effects (font (size 1.27 1.27)) hide)
    )
  )

  (symbol (lib_id "power:GNDREF") (at 47.498 156.972 270) (unit 1)
    (in_bom yes) (on_board yes) (dnp no)
    (uuid 5cb96c3c-8c35-4c87-b6da-809f1bbb604c)
    (property "Reference" "#PWR019" (at 41.148 156.972 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Value" "GNDREF" (at 41.148 156.972 90)
      (effects (font (size 1.27 1.27)))
    )
    (property "Footprint" "" (at 47.498 156.972 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (property "Datasheet" "" (at 47.498 156.972 0)
      (effects (font (size 1.27 1.27)) hide)
    )
    (pin "1" (uuid aed6f3da-4f21-4a5b-8721-4373ac4e907a))
    (instances
      (project "2S3P Power Board"
        (path "/464772aa-90d5-4a0f-9461-eccd25d5c108/3c654e1a-3c36-49b6-8aed-6b5c58dd8ff9"
          (reference "#PWR019") (unit 1)
        )
        (path "/464772aa-90d5-4a0f-9461-eccd25d5c108/0d1ed757-7ff1-4d63-85b4-75a7d49f8712"
          (reference "#PWR020") (unit 1)
        )
      )
      (project "mainboard"
        (path "/655f8d84-b4be-4397-b016-a9d658ca4447/00000000-0000-0000-0000-00005cec5dde"
          (reference "#PWR01") (unit 1)
        )
      )
    )
  )
)
